---
title: go-zero框架的学习-2-书店微服务
tags:
  - null
categories:
  - technical
  - null
toc: true
declare: true
date: 2022-01-17 21:05:47
---

> * https://github.com/zeromicro/zero-doc/blob/main/docs/zero/bookstore.md

记录重难点

<!-- more -->

# 一、基本需求

实现一个书店服务,只实现两个功能：

* 增加书目
* 检查价格

整体流程：

![image-20220118090414624](http://xwjpics.gumptlu.work/image-20220118090414624.png)

# 二、各类文件的理解

生成API 网关：

* 编写`.api`文件的意义：

  * `info`：描述一个api服务

  * `type`：定义服务中请求体、返回体的类

  * `service`：定义了api服务（服务名称，服务metadata，中间件声明，路由，handler等），其中@handler就指定了对应请求的逻辑处理函数

  > 具体详细的规范可见：https://go-zero.dev/cn/api-grammar.html

生成某一个rpc服务：

* 编写`.proto`文件的意义：
  * `message`: 定义rpc消息传递的请求体描述、返回体描述
  * `service`: 此服务的描述

生成一个CRUD+Redis cache:

* 编写一个数据库表`sql`文件

# 三、go-zero总体开发思路

![image-20220118141013688](http://xwjpics.gumptlu.work/image-20220118141013688.png)

https://go-zero.dev/cn/dev-flow.html

官方给出了整体的开发流程：

- goctl环境准备
- 数据库设计
- 业务开发
- 新建工程
- 创建服务目录
- 创建服务类型（api/rpc/rmq/job/script）
- 编写api、proto文件
- 代码生成
- 生成数据库访问层代码model
- 配置config，yaml变更
- 资源依赖填充（ServiceContext）
- 添加中间件
- 业务代码填充
- 错误处理
