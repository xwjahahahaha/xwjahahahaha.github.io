---
title: 124.二叉树中的最大路径和
tags:
  - null
categories:
  - technical
  - leetcode
toc: true
date: 2022-01-14 20:31:46
---

## 题目描述

[124. 二叉树中的最大路径和](https://leetcode-cn.com/problems/binary-tree-maximum-path-sum/)

难度困难1374

**路径** 被定义为一条从树中任意节点出发，沿父节点-子节点连接，达到任意节点的序列。同一个节点在一条路径序列中 **至多出现一次** 。该路径 **至少包含一个** 节点，且不一定经过根节点。

**路径和** 是路径中各节点值的总和。

给你一个二叉树的根节点 `root` ，返回其 **最大路径和** 。

 <!-- more -->

**示例 1：**

![img](http://xwjpics.gumptlu.work/qinniu_uPic/exx1.jpg)

```
输入：root = [1,2,3]
输出：6
解释：最优路径是 2 -> 1 -> 3 ，路径和为 2 + 1 + 3 = 6
```

**示例 2：**

![img](http://xwjpics.gumptlu.work/qinniu_uPic/exx2.jpg)

```
输入：root = [-10,9,20,null,null,15,7]
输出：42
解释：最优路径是 15 -> 20 -> 7 ，路径和为 15 + 20 + 7 = 42
```

 

**提示：**

- 树中节点数目范围是 `[1, 3 * 104]`
- `-1000 <= Node.val <= 1000`

## 解题思路及代码

```go
/**
 * Definition for a binary tree node.
 * type TreeNode struct {
 *     Val int
 *     Left *TreeNode
 *     Right *TreeNode
 * }
 */

// 对于一个树的基本单元：父节点、左孩子、右孩子
// 考虑全局最大路径和有三种情况：
//  只选择一个孩子加上父节点向上递归：
//      1. 左 + 父
//      2. 右 + 父
//  从左到右经过父节点，不再向上递归(注意：这个情况不能作为此节点的最大路径和，因为路径不会向上了，但是可以是全局的一条路径，所以要考虑判断)：
//      3. 左 + 父 + 右
// 对于左右孩子的最大路径和可以递归往下计算，然后再加上自己（父节点，其一定要经过）
// 维护一个全局的最大和，不断比较，当递归到根结点时递归结束（注意：到根结点不一定是最大的）
func maxPathSum(root *TreeNode) int {
    max := math.MinInt32        // 最大值初始化不能设置为0，因为可能整个树都是负的，最大值为一负数
    var dfs func(*TreeNode) int         // 返回此节点的最大路径值
    dfs = func(root *TreeNode) int {
        if root == nil {
            return 0
        }
        // 计算本节点的路径最大值
        leftMax, rightMax := dfs(root.Left), dfs(root.Right)
        if leftMax < 0 { leftMax = 0 }  // 如果孩子分支为负数宁愿不加，所以设置为0
        if rightMax < 0 { rightMax = 0}
        // 判断加上哪个孩子最大, 返回自己的值
        lrMax := leftMax + root.Val
        if rightMax + root.Val > lrMax {
            lrMax = rightMax + root.Val
        }
        // 计算三者直接连接最不是最大，比较一下全局最大，让其更新
        lmr := root.Val + leftMax + rightMax
        if lmr > lrMax && lmr > max {
            max = lmr
        }else if lrMax > max {
            max = lrMax
        }
        // 返回本节点最大值
        return lrMax
    }
    dfs(root)
    return max
}
```

