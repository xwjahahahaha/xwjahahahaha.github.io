---
title: 实现半自动化安装
tags:
  - null
categories:
  - technical
  - null
toc: true
declare: true
date: 2022-01-24 10:20:12
---



<!-- more -->

# 一、需求说明

* 实现linux操作系统的半自动化安装



# 二、前置知识

## 1. kickstart 

作用：

* 实现自动化安装，系统管理员可以先创建一个描述安装需要信息的文件（`anaconda-ks.cfg`），使用`kickstart`就可以实现自动化安装

## 2. anaconda-ks.cfg

作用：

* 记录安装系统时的一些信息
* 可以配合`kickstart`实现类似系统的自动化安装

自动化安装的大致流程：

* 把这个文件经修改之后放入U盘，命名为`ks.cfg`

* 在装系统时，出现boot[界面](https://www.baidu.com/s?wd=界面&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd)时就可以输入：

  ```shell
  #ks的路径视你的U盘的为哪个盘而定
  linux ks=/dev/sdb:/yourpath/ks.cfg
  ```

# 三、设计方案

麒麟由于.iso不可修改，依然提供安装部署说明书，仅提供人工安装

欧拉利用kickstart完成半自动化安装，流程如下：

![image-20220124103921231](http://xwjpics.gumptlu.work/image-20220124103921231.png)

步骤描述：

1. 利用kickstart原生属性，使用%pre，在安装前执行我们自己定义的脚本
2. 利用dialog，实现可视化界面的安装操作
3. 用户自行选择语言，暂时只支持中文和英文，用于后面安装展示中文还是英文
4. 用户自行配置网络，提取参数，保存至/install_record.cfg文件
5. 用户自行选择系统盘，提取参数，保存至/install_record.cfg文件
6. 生成新的动态cfg文件，在anaconda-ks.cfg将其include，即可完成动态安装的效果
7. 在第三方iso引导界面追加ks文件路径，ks=cdrom:/install/anaconda-ks.cfg，并ctrl-c即可触发半自动化安装

